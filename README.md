# Анализ файла `main.py.py`

Вот подробный анализ файла `main.py` из репозитория `bot-for-the-class-schedule` (commit 686ea7649f):

---

### **1️⃣ Назначение файла (по смыслу кода)**

Файл `main.py` — это **основной исполняемый модуль телеграм-бота**, предназначенного для автоматического предоставления школьного расписания ученикам и учителям. Бот:

- **Автоматически загружает** актуальное расписание из Excel-файла, хранящегося на Яндекс.Диске (ежедневно в 04:50 и 13:00).
- **Позволяет пользователю выбрать роль**: ученик или учитель.
- **Для учеников**:
  - Предоставляет расписание по классам (1–11) на сегодня, завтра или на неделю.
  - Автоматически подставляет ФИО учителей вместо номеров в скобках в расписании.
- **Для учителей**:
  - Позволяет выбрать своего ФИО из списка (функционал выбора реализован, но **не используется** — нет обработки callback-данных учителей).
- **Поддерживает команды**: `/start`, `/help`, `/contact`, `/support`.
- **Использует `schedule`** для периодического обновления расписания из облака.
- **Хранит состояние пользователей** (роль и выбранный класс) в словаре `users`.

> **Важно**: Функционал для учителей **неполный** — кнопки отображаются, но при выборе учителя ничего не происходит. Это баг/недоработка.

---

### **2️⃣ Таблица: Имя | Тип | Назначение | Взаимодействия**

| Имя | Тип | Назначение | Взаимодействия |
|-----|-----|------------|----------------|
| `time`, `telebot`, `requests`, `pandas`, `schedule`, `numpy`, `re`, `datetime`, `os` | Импорт | Импорты библиотек для работы с Telegram API, HTTP, Excel, расписанием, регулярками и таймингом | Используются повсеместно: `telebot` — для бота, `pandas` — для чтения Excel, `schedule` — для таймера, `re` — для парсинга строк |
| `bot` | Переменная (объект) | Экземпляр телеграм-бота с токеном | Используется во всех обработчиках (`message_handler`, `callback_query_handler`) |
| `download_file()` | Функция | Загружает Excel-файл с Яндекс.Диска по публичной ссылке и сохраняет как `downloaded_file.xlsx` | Вызывается `job()`, которая запускается по расписанию. Используется `requests`, `urllib.parse.urlencode` |
| `job()` | Функция | Обёртка для `download_file()`, используется для планировщика | Вызывается `schedule.every().day.at(...).do(job)` |
| `User` | Класс | Хранит информацию о пользователе: роль и выбранный класс/ФИО | Используется в